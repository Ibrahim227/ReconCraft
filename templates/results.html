<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Recon Results for {{ domain }}</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body.dark-mode {
      background-color: #121212;
      color: #e0e0e0;
    }
    .dark-mode .card {
      background-color: #1e1e1e;
      border-color: #333;
    }
    .dark-mode .list-group-item {
      background-color: #2a2a2a;
      border-color: #444;
      color: #e0e0e0;
    }
    .dark-mode .section-header,
    .dark-mode .btn-outline-secondary,
    .dark-mode .btn-outline-primary,
    .dark-mode .btn-outline-success {
      color: #90caf9 !important;
      border-color: #90caf9 !important;
    }
    .section-header {
      font-weight: bold;
      text-transform: uppercase;
      border-bottom: 3px solid #0d6efd;
      margin-bottom: 1rem;
      padding-bottom: .5rem;
    }
    .subdomain-badge {
      font-size: .85rem;
      margin-left: .5rem;
    }
    .floating-filter-bar {
      flex: 1 0 100%;
      margin-top: 1rem;
    }
  </style>
</head>
<body class="bg-light">
<div class="container py-5">
  <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap gap-2">
    <h1 class="mb-0 fs-3">üîç Recon Results for <strong>{{ domain }}</strong></h1>
    <div class="floating-filter-bar">
      <input type="text" class="form-control" id="global-filter" placeholder="üîé Filter subdomains or URLs">
    </div>
    <button id="toggle-theme" class="btn btn-outline-secondary btn-sm">üåì</button>
  </div>

  {% macro card(title, id, color_class, items) %}
    <div class="col-md-6 col-lg-3">
      <div class="card shadow-sm h-100">
        <div class="card-body" id="{{ id }}">
          <h5 class="section-header">{{ title }}
            <span class="badge {{ color_class }} subdomain-badge">{{ items|length }}</span>
          </h5>
          {% if items %}
            <ul class="list-group list-group-flush" style="max-height: 220px; overflow-y: auto;">
              {% for sub in items %}
                <li class="list-group-item d-flex justify-content-between align-items-center">
                  {{ sub }}
                  <button onclick="navigator.clipboard.writeText('{{ sub }}')" class="btn btn-sm btn-outline-secondary" title="Copy">üìã</button>
                </li>
              {% endfor %}
            </ul>
          {% else %}
            <p class="text-muted mb-0">No results from {{ title }}.</p>
          {% endif %}
        </div>
      </div>
    </div>
  {% endmacro %}

  <div class="row g-4 mb-4">
    {{ card('Subfinder', 'subfinder', 'bg-primary', subfinder_subdomains) }}
    {{ card('Assetfinder', 'assetfinder', 'bg-info text-dark', assetfinder_subdomains) }}
    {{ card('Alterx', 'alterx', 'bg-warning text-dark', alterx_subdomains) }}
    {{ card('Httpx (Active)', 'httpx', 'bg-success', httpx_subdomains) }}
  </div>

  <div class="row g-4 mb-4">
    {{ card('DNSX (Resolved)', 'dnsx', 'bg-success', dnsx_subdomains) }}
    {{ card('CRT.sh', 'crtsh', 'bg-info text-dark', crtsh_subdomains) }}
    {{ card('Crawled URLs', 'urls', 'bg-dark', urls) }}
  </div>

  <div class="row g-4 mb-4">
    {{ card('Passive Subdomains', 'passive', 'bg-info text-dark', passive) }}
    {{ card('Active Subdomains', 'active', 'bg-success', active) }}
  </div>
</div>

<script>
  // Theme toggle
  const toggleTheme = document.getElementById("toggle-theme");
  toggleTheme.addEventListener("click", () => {
    document.body.classList.toggle("dark-mode");
    localStorage.setItem("theme", document.body.classList.contains("dark-mode") ? "dark" : "light");
  });

  window.addEventListener("DOMContentLoaded", () => {
    if (localStorage.getItem("theme") === "dark") {
      document.body.classList.add("dark-mode");
    }
  });

  // Global filter
  const filterInput = document.getElementById("global-filter");
  filterInput.addEventListener("input", function () {
    const query = this.value.toLowerCase();
    document.querySelectorAll(".list-group-item").forEach(item => {
      const match = item.textContent.toLowerCase().includes(query);
      item.style.display = match ? "" : "none";
    });
  });
</script>
</body>
</html>
